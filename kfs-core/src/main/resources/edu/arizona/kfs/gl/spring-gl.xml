<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
                           http://www.springframework.org/schema/tx
                           http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
                           http://www.springframework.org/schema/aop
                           http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">

    <bean id="glModuleConfiguration" parent="glModuleConfiguration-parentBean" >
        <property name="packagePrefixes">
            <list merge="true">
                <value>edu.arizona.kfs.gl</value>
            </list>
        </property>
        <property name="dataDictionaryPackages">
            <list merge="true">
                <value>classpath:edu/arizona/kfs/gl/businessobject/datadictionary/*.xml</value>
            </list>
        </property>
        <property name="databaseRepositoryFilePaths">
            <list merge="true">
                <value>edu/arizona/kfs/gl/ojb-gl.xml</value>
            </list>
        </property>
        <property name="jobNames">
			<list>
				<value>enterpriseFeedJob</value>
				<value>collectorJob</value>
				<value>nightlyOutJob</value>
				<value>budgetAdjustmentCashTransferJob</value>
				<value>scrubberJob</value>
				<value>posterJob</value>
				<value>posterBalancingJob</value>
				<value>sufficientFundsAccountUpdateJob</value>
                <value>sufficientFundsFullRebuildJob</value>
                <value>clearPendingEntriesJob</value>
				<value>encumbranceForwardJob</value>
				<value>balanceForwardJob</value>
				<value>nominalActivityClosingJob</value>
				<value>organizationReversionPriorYearAccountJob</value>
				<value>organizationReversionCurrentYearAccountJob</value>
				<value>manualPurgeJob</value>
				<value>posterBalancingHistorySyncJob</value>
            </list>
		</property>
    </bean>

    <bean id="collectorJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="collectorStep" />
            </list>
        </property>
    </bean>

    <bean id="nightlyOutJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="nightlyOutStep" />
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="autoClosePurchaseOrdersJob" value="softDependency" />
                <entry key="autoCloseRecurringOrdersJob" value="softDependency" />
                <entry key="processPdpCancelsAndPaidJob" value="hardDependency"/>
                <entry key="assetDepreciationBatchJob" value="hardDependency"/>
            </map>
        </property>
    </bean>

	<bean id="budgetAdjustmentCashTransferJob" parent="unscheduledJobDescriptor">
		<property name="steps">
			<list>
				<ref bean="glBudgetAdjustmentMergeSortStep"/>
				<ref bean="glBudgetAdjustmentExtractStep"/>
				<ref bean="glBudgetAdjustmentGenerationStep"/>
			</list>
		</property>
	</bean>
	
    <bean id="scrubberJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="createBackupGroupStep" />
                <ref bean="preScrubberStep" />
                <ref bean="scrubberSortStep" />
                <ref bean="scrubberStep" />
                <ref bean="demergerSortStep" />
                <ref bean="demergerStep" />
                <ref bean="aggregateGlScrubberReportsStep"/>
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="enterpriseFeedJob" value="hardDependency"/>
                <entry key="collectorJob" value="softDependency" />
                <entry key="nightlyOutJob" value="hardDependency" />
                <entry key="clearLaborPendingEntriesJob" value="hardDependency" />
                <entry key="pdpExtractGlTransactionsStepJob" value="hardDependency" />
            </map>
        </property>
    </bean>

	<bean id="glBudgetAdjustmentTransactionDao" parent="platformAwareDao" class="edu.arizona.kfs.gl.dataaccess.impl.BudgetAdjustmentTransactionDaoOjb"/>
	
	<bean id="glBudgetAdjustmentCashTransferService" parent="glBudgetAdjustmentCashTransferService-parentBean"/>
	<bean id="glBudgetAdjustmentCashTransferService-parentBean" abstract="true" class="edu.arizona.kfs.gl.batch.service.impl.BudgetAdjustmentCashTransferServiceImpl">
		<property name="budgetAdjustmentTransactionDao">
			<ref bean="glBudgetAdjustmentTransactionDao" />
		</property>	
		<property name="optionsService">
			<ref bean="optionsService" />
		</property>		
		<property name="parameterService">
			<ref bean="parameterService" />
		</property>
		<property name="dateTimeService">
			<ref bean="dateTimeService" />
		</property>		
		<property name="runDateService">
			<ref bean="glRunDateService"/>
		</property>
		<property name="reportWriterService">
			<ref bean="glBudgetAdjustmentGenerationReportWriterService" />
		</property>
		<property name="universityDateService">
			<ref bean="universityDateService" />
		</property>
		<property name="batchFileDirectoryName" value="${staging.directory}/gl/originEntry"/>		
	</bean>
	
	<bean id="glBudgetAdjustmentMergeSortStep" class="edu.arizona.kfs.gl.batch.BudgetAdjustmentMergeSortStep" parent="step">
		<property name="batchFileDirectoryName" value="${staging.directory}/gl/originEntry"/>
	</bean>
		
	<bean id="budgetAdjustmentTransactionReportHelper" parent="businessObjectReportHelper">
		<property name="dataDictionaryBusinessObjectClass" value="edu.arizona.kfs.gl.businessobject.BudgetAdjustmentTransaction"/>
		<property name="orderedPropertyNameToHeaderLabelMap">
			<map>
				<entry key="universityFiscalYear" value="YEAR"/>
				<entry key="chartOfAccountsCode" value="COA"/>
				<entry key="accountNumber" value="ACCOUNT"/>
				<entry key="subAccountNumber" value="SACCT"/>
				<entry key="financialObjectCode" value="OBJ"/>
				<entry key="financialSubObjectCode" value="SOBJ"/>
				<entry key="financialBalanceTypeCode" value="BT"/>
				<entry key="financialObjectTypeCode" value="OT"/>
				<entry key="universityFiscalPeriodCode" value="PRD"/>
				<entry key="financialDocumentTypeCode" value="DTYP"/>
				<entry key="documentNumber" value="RBC #"/>
				<entry key="transactionLedgerEntrySequenceNumber" value="SEQ #"/>
				<entry key="organizationDocumentNumber" value="DOC #"/>
			</map>
		</property>
		<property name="columnCount" value="13" />
	</bean>
	
	<bean id="glBudgetAdjustmentGenerationReportWriterService" parent="glBudgetAdjustmentGenerationReportWriterService-parentBean"/>
	<bean id="glBudgetAdjustmentGenerationReportWriterService-parentBean" abstract="true"  parent="reportWriterService">
		<property name="filePath" value="${reports.directory}/gl"/>
		<property name="fileNamePrefix" value="budgetAdjustmentCashTransfer_"/>
        <property name="title" value="Budget Adjustment Cash Transfer Generation Report"/>
        <property name="classToBusinessObjectReportHelperBeanNames">
        	<map>
        		<entry key="org.kuali.kfs.gl.businessobject.OriginEntryFull" value="transactionReportHelper"/>
        		<entry key="edu.arizona.kfs.gl.businessobject.BudgetAdjustmentTransaction" value="budgetAdjustmentTransactionReportHelper"/>
        	</map>
       	</property>       	
    </bean>
    
    <bean id="glBudgetAdjustmentExtractStep" class="edu.arizona.kfs.gl.batch.BudgetAdjustmentExtractStep" parent="wrappedStep">
		<property name="wrappingBatchServices">
			<list>				
				<ref bean="glBudgetAdjustmentGenerationReportWriterService" />
			</list>
		</property>
		<property name="budgetAdjustmentCashTransferService" ref="glBudgetAdjustmentCashTransferService" />
	</bean>	
	
	<bean id="glBudgetAdjustmentGenerationStep" class="edu.arizona.kfs.gl.batch.BudgetAdjustmentGenerationStep" parent="wrappedStep">
		<property name="wrappingBatchServices">
			<list>				
				<ref bean="glBudgetAdjustmentGenerationReportWriterService" />
			</list>
		</property>
		<property name="budgetAdjustmentCashTransferService" ref="glBudgetAdjustmentCashTransferService" />
	</bean>

    <bean id="posterJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="posterSortStep" />
                <ref bean="posterEntriesStep" />
                <ref bean="posterReversalStep" />
                <ref bean="posterIndirectCostRecoveryGenerationStep" />
                <ref bean="icrSortStep" />
                <ref bean="posterIndirectCostRecoveryEntriesStep" />
                <ref bean="icrEncumbranceFeedStep" />
                <ref bean="icrEncumbranceSortStep" />
                <ref bean="posterIcrEncumbranceEntriesStep" />
                <ref bean="fileRenameStep" />
                <ref bean="posterSummaryReportStep" />
                <ref bean="aggregateGlPosterReportsStep" />
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="scrubberJob" value="hardDependency" />
                <entry key="sufficientFundsAccountUpdateJob" value="hardDependency" />
            </map>
        </property>
    </bean>

    <bean id="posterBalancingJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="posterBalancingStep"/>
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="posterJob" value="hardDependency" />
            </map>
        </property>
    </bean>

    <bean id="sufficientFundsAccountUpdateJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="sufficientFundsAccountUpdateStep" />
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="nightlyOutJob" value="hardDependency" />
            </map>
        </property>
    </bean>

    <bean id="clearPendingEntriesJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="clearPendingEntriesStep" />
            </list>
        </property>
        <property name="dependencies">
            <map>
                <entry key="posterJob" value="hardDependency" />
            </map>
        </property>
    </bean>

    <bean id="enterpriseFeedJob" parent="unscheduledJobDescriptor">
        <property name="steps">
            <list>
                <ref bean="enterpriseFeedStep" />
            </list>
        </property>
    </bean>

</beans>
